# ===========================================
# EVOTINGAPP
# Qt 6 + MySQL + C++ Backend
# ===========================================

cmake_minimum_required(VERSION 3.16)
project(EVOTINGAPP VERSION 1.0 LANGUAGES CXX)

# ---------------------------------------
# Global C++ & Qt Settings
# ---------------------------------------
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTORCC ON)

# ---------------------------------------
# Find Qt6 and Required Modules
# ---------------------------------------
find_package(Qt6 REQUIRED COMPONENTS Widgets Sql)

# ---------------------------------------
# Include Project Directories
# ---------------------------------------
include_directories(
    ${CMAKE_SOURCE_DIR}/backend
    ${CMAKE_SOURCE_DIR}/frontend
)

# ---------------------------------------
# Collect All Source Files
# ---------------------------------------
file(GLOB_RECURSE BACKEND_SRC CONFIGURE_DEPENDS "${CMAKE_SOURCE_DIR}/backend/*.cpp")
file(GLOB_RECURSE FRONTEND_SRC CONFIGURE_DEPENDS "${CMAKE_SOURCE_DIR}/frontend/*.cpp")

# ---------------------------------------
# Define the Executable
# ---------------------------------------
add_executable(EVOTINGAPP
    ${BACKEND_SRC}
    ${FRONTEND_SRC}
)

# ---------------------------------------
# Link Qt Libraries
# ---------------------------------------
target_link_libraries(EVOTINGAPP
    Qt6::Widgets
    Qt6::Sql
)

# ---------------------------------------
# Windows-specific (optional)
# Hide console window for GUI app
# ---------------------------------------
if(WIN32)
    set_target_properties(EVOTINGAPP PROPERTIES
        WIN32_EXECUTABLE TRUE
    )
endif()

# ---------------------------------------
# Output Directory
# ---------------------------------------
set_target_properties(EVOTINGAPP PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin
)

# ---------------------------------------
# Optional: Post-build message
# ---------------------------------------
message(STATUS "✅ EVOTINGAPP configured successfully.")
message(STATUS "➡️  Output binary: ${CMAKE_BINARY_DIR}/bin/EVOTINGAPP")
message(STATUS "➡️  Using Qt version: ${Qt6_VERSION}")
